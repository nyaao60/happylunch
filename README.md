# <a href="https://haplunch.com//">ハピランチ</a>

  ## アプリの概要
  **サービス名：ハピランチ**<br>
  　　　**URL：<https://haplunch.com>**<br>
   
   数ある作品の中から御覧いただき、誠にありがとうございます。<br>
   「ハピランチ」とは、HAPPY（幸せ）とLUNCH（ランチ）を融合させた造語であり、<br>
   社会人の皆様のランチタイムをより充実させたいという想いで作成したサービスです。<br>
  当サービスは、現在地や目的地からお近くの、手頃で美味しい健康的なランチメニューやお弁当を<br>
  簡単に検索し、共有できるプラットフォームです。<br>
  他の飲食店情報提供サービスとは一線を画し、当サービスは、メニューそのものの情報に焦点を当て、効率的なランチ選びを目指しました。<br>
  
  なお、当アプリは、公式マニュアルや技術記事を参考にし、独学で開発を行いました。<br>
  培った知識を精一杯活かして作成したため、少しでもお試しいただければ幸いです。<br>
  ※以下の通り、ゲストログイン機能を実装しておりますので、お気軽にお試しください。<br>

### ゲストログイン
以下の手順で、ゲストユーザーとしてログインできます。<br>
TOPページ右上のログインボタンを押下→ログイン画面の”ユーザー登録せずに機能を試したい方はこちら”というリンクを押下<br>

<img alt="ゲストログイン画面" src= '/README_images/ゲストログイン画面.gif' >

## 画面イメージ

### TOP画面
<img alt="トップページ画面" src= '/README_images/TOP画像.png' >


### 投稿検索画面
HOME画面の検索フォームでは、現在地の情報を取得し、そこから一定の距離範囲内のお店のランチ<br>
を複数の検索条件を使用して検索できます。位置は、特定の場所を指定することも可能です。<br>

<img alt="現在地検索画面" src= '/README_images/現在地検索画面.gif' >


### キーワード検索画面
現在の位置情報に依存せずに、幅広く投稿を検索できるように<br>
キーワード検索やハッシュタグの機能も実装しました。<br>

<img alt="キーワード検索画面" src= '/README_images/キーワード検索画面.gif' >


### お気に入りの投稿画面
お気に入りの投稿は、いいねをすると、ユーザーページでいつでも見返すことができます。<br>

<img alt="投稿のいいね画面" src= '/README_images/いいね画面.gif' >


## ハピランチの開発背景
私は、会社に出勤する際、栄養面を考慮し、昼食にお弁当を持参していました。<br>
しかし、仕事が忙しくなると、時間を確保することができず、次第に近くのコンビニやスーパーで弁当を購入するようになりました。<br>
これらの弁当はクオリティが年々向上しているものの、飲食店の料理と比べると、満足できる味や栄養が得られず、飽きてしまいました。<br>
そのような中で、会社のランチタイムは時間が限られていることもあり、効率的に、美味しく栄養豊富なランチの情報を得たいと考え、「ハピランチ」の開発に至りました。<br>
<br>
現在、ランチの情報を取得する際は、お店の評価を調べることができる大手サイトがよく利用されています。<br>
しかし、例えば野菜料理を食べたいと思った場合、お店の評価サイトでは、お店自体の評価はすぐにわかりますが、食べたい野菜メニューの情報に迅速に辿り着けません。<br>
また、Instagram等のSNSで調べる方法もありますが、投稿の内容はバラバラで、評価基準が統一されておらず、予算や距離、実際に美味しいのか等が見極めづらいです。<br>
以上のような課題に対し、当サービスは、既存のサービスと差別化し、予算等の一定の条件を保持しつつ、お店でなく、メニューそのものに特化した口コミや評価を迅速に得ることができるようなサービスとしました。<br>

## 使用技術
### バックエンド
・Ruby(2.7.6)<br>
・Ruby on Rails (6.0.6)<br>
・MySQL(8.0.32)<br>
・Puma<br>
・Nginx<br>
### フロントエンド
・HTML/CSS<br>
・Javascript<br>
### 開発環境、インフラ
・docker/docker-compose<br>
・GitHub Actions(CI/CD)<br>
・AWS(Route53,ALB,VPC,subnet,ECR,ECS,RDS(MySQL),ACM,S3)<br>
### テスト
・Rspec<br>
## 機能一覧/詳細
### ユーザー機能
・新規登録、詳細表示、編集、削除（退会）機能<br>
　・編集時、画像プレビュー機能<br>
・ログイン（永続ログイン）、ログアウト機能<br>
・フォロー機能（フォロー機能参照）<br>
・ゲストユーザーログイン機能<br>
・管理者機能<br>
　・ユーザーの削除、投稿の削除、ユーザー一覧表示、投稿一覧表示機能<br>
### フォロー機能
・フォロー、フォロー解除機能<br>
・フォロー、フォロワー一覧表示機能<br>
・フォローしたユーザーの投稿をホーム画面のタイムラインに表示する機能<br>
### 投稿に関する機能
・新規作成、詳細表示、編集、削除機能<br>
　・新規作成、編集画面にて、画像プレビュー機能<br>
　・詳細表示画面にて、googleAPIによる地図情報確認機能<br>
・投稿検索機能（投稿検索機能参照）<br>
・いいね機能（いいね機能参照）<br>
・コメント機能（コメント機能参照）<br>
### 投稿検索機能（gem未使用）
・googleAPIを用いた、現在地取得機能<br>
・googleAPIを用いた、投稿検索機能<br>
（特定の距離範囲内で、現在地から近い順、料金が安い順、おすすめ度順、野菜豊富メニュー絞り込みの条件で投稿検索が可能）<br>
・キーワード検索機能<br>
・ハッシュタグ検索機能
### ハッシュタグ機能
・投稿作成時にハッシュタグを付与する機能<br>
・タイムライン投稿や、投稿詳細画面にてハッシュタグを表示する機能<br>
・特定のハッシュタグがついた投稿をまとめて表示する機能<br>
### いいね機能
・投稿にいいね、いいね解除ができる機能<br>
・ユーザー詳細画面にてにいいねをした投稿を一覧表示する機能<br>
### コメント機能
・投稿ごとにコメントを新規作成、表示、削除する機能<br>
###
## 特に工夫した点
### <strong>メニューに焦点を当てた検索サービス</strong>
ランチを調べる際によく利用される既存の大手のサービスは、”お店”の情報を検索するアプリケーションが多く、実際に食べることができる”メニュー”の情報に直結していないと考えたため、当サービスは、ランチメニューそのものに焦点を当て、メニューそのものの美味しさの評価や野菜の豊富さ等を迅速に取得できるようなサービスに設計しました。<br>
### <strong>GoogleAPI等を用いて情報を多角的に取得</strong>
・GoogleAPIを用いて、現在地を取得できるようにし、現在地から一定の距離範囲内のランチ情報を取得できるように設計しました。<br>
・検索条件に、様々な検索オプション（現在地から近い順・料金が安い順・おすすめ度順・野菜が豊富なメニュー）を設けることで、情報を多角的に取得できるようにしました。<br>
・GoogleAPIを用いて、投稿情報に住所地図を付加することで、ユーザーが素早く、正確に位置情報を把握できるように、設計しました。<br>
・投稿内のキーワードからも投稿を検索できるようにし、現在の位置情報に依存せずに、キーワードを通じて投稿を検索できるため、より広範に情報を取得できるようにしました。<br>
・人気のハッシュタグ機能を実装することで、ハッシュタグの人気度や頻度から、トレンドや注目のテーマの情報を取得できるようにしました。<br>
### <strong>シームレスなDocker運用、効率的なCI/CDパイプライン</strong>
・開発環境と本番環境の差異による問題に対応するため、Dockerを使用して開発を行い、本番環境では、Dockerと相性の良いAWS ECS(Fargate)を利用し、Dockerイメージの管理のみに集中できるサーバーレスな運用を実現しました。<br>
・AWS Route53, ACM, ALBを用いて、独自ドメイン＋常時SSL通信(HTTPS)を実現しました。<br>
・Github Actionsを用いてCI/CDパイプラインを構築しました。<br>
### <strong>N+1問題の解消</strong>
当アプリでは、投稿一覧を表示する際に、各投稿に関連するユーザー情報、いいね数、コメント数、タグなどを取得する必要がありました。<br>
初期の実装では、各投稿ごとに別々のデータベースクエリが実行され、N+1問題が発生し、ページの読み込み速度が遅くなっていました。<br>
そこで、`includes` メソッドを活用する等し、1つのクエリで必要なデータをまとめて取得することで、効率的なデータベースアクセスを実現しました。<br>
また、上記の問題の解消に取り組む中で、DBのデータ抽出メソッドや結合関係等SQLの基本を学べたと共に ActiveRecordのメリット、デメリットを理解できました。
## インフラ構成
<img width="1286" alt="インフラ構成図" src="/README_images/インフラ構成図.png">

## ER図　
<img width="950" alt="ER図" src="/README_images/ER図1.png">


## 現時点での課題、将来的に実装予定の機能（2023年9月20日現在）
・レスポンシブデザイン実装予定<br>
　現在横幅、1280px〜1920pxまでのPCサイズでのみ、レイアウトの崩れがないことを確認。
<br>
・検索フォームの現在地の取得に時間がかかるため、改善予定<br>
・添付画像の画質が悪いため、アップロード時の画質の劣化を軽減予定<br>
・現在地から距離が近い順の検索で、指定の場所とお店間の距離を表示するように改善予定<br>
・Vuejsによる完全SPA化、UXの向上を実装予定（いいね、フォローなどのボタンアニメーション）<br>
・投稿ありきのサービスで、現在投稿数が少ないため、投稿数に応じてポイントが付与されるような投稿意欲を促 進させる機能を実装予定<br>
